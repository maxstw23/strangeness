#include "NpartNormalizer.h"
#include "TString.h"

const float NpartNormalizer::ratio_s_ox[] =
{
    0.710381032035995, 0.827996759152623, 0.7365183122178056, 0.7911194239510341, 0.8824623432600894, 0.8441384393092661, 0.8474733573360502, 0.8497271305622339, 0.8519438373359728, 0.8768551308067533, 
    0.8269679608945716, 0.8526611997697917, 0.817359035476286, 0.876458816130411, 0.870201318472891, 0.8120969756958649, 0.8751438330876599, 0.8719418396320846, 0.8423065185054956, 0.8990159284362809, 
    0.8452171551074233, 0.9002045901793492, 0.8959908675168691, 0.899407944098407, 0.8818939042455597, 0.9050264662627795, 0.9170756253198521, 0.8999271018882419, 0.8906640178614342, 0.9195799150384777, 
    0.9422965297617856, 0.9227019970744431, 0.8793367294529955, 0.9172624953721713, 0.9679864086976919, 0.9396142413774843, 0.9451516172663901, 0.9566079581605654, 0.9305841155019337, 0.9476964497224866, 
    0.9086070840356065, 0.9598402085107058, 0.9565953417132473, 0.9713402202526465, 0.9881924824506647, 0.979816743999232, 0.9896988319465171, 0.970917484179013, 0.988807830639878, 0.9828820060840451, 
    0.9945504732732793, 1.0105632959552688, 0.9809023396981248, 0.9775022257525352, 1.0082848123715726, 1.0122229087500845, 1.0286086536457144, 1.0077797868745089, 1.0294929679127316, 1.035016529336812, 
    1.0190680135144803, 1.036542433324506, 1.051351388366182, 1.056348854308517, 1.058851903407212, 1.057871326550175, 1.0546742869412498, 1.0888374700004697, 1.0517007503284976, 1.0683775748718878, 
    1.066612945631182, 1.0750834836378187, 1.0732947036156606, 1.1127494384844276, 1.101423989713613, 1.058427673092467, 1.1178699737385067, 1.0989322690103123, 1.1162543681303945, 1.1211536120870595
};


const float NpartNormalizer::ratio_s_oxb[] = 
{
    0.7845469066087818, 0.8822898780576565, 0.8650093089528937, 0.8093072592494877, 0.814940274175802, 0.9404200769468154, 0.8226351159518944, 0.8258176257643361, 0.8353376096931847, 0.8060525893145527, 
    0.8433469396935491, 0.8367512244974037, 0.8443517375664868, 0.8609325863525996, 0.830803501188972, 0.874176255329582, 0.7930574234328407, 0.797140690350116, 0.9633723801090306, 0.8827794199874701, 
    0.8094145892534872, 0.8622606599444976, 0.8408160943634688, 0.9033117050036577, 0.8882780693963324, 0.8856490759344879, 0.8833761123964817, 0.9098988056066954, 0.8988776106607793, 0.9068739992366049, 
    0.9372409025413374, 0.9091192146494911, 0.9139880722466597, 0.9391654843792202, 0.9183844578387007, 0.9060147901875835, 0.9344661378066339, 0.9089084471220328, 0.9329889083351556, 0.9389107739085321, 
    0.9565097981333854, 0.9787984958287411, 0.9903629668438876, 0.9843742869521768, 0.9794097587262485, 0.9677727070829377, 0.9772879824370004, 0.9540594837379307, 0.9653263703852363, 1.0322098983946888, 
    1.0070694533103113, 0.9676689225970542, 1.0137322323204045, 1.009141883766465, 1.0228474987920018, 1.02776740630469, 0.9996498108144496, 1.0264430650378653, 1.029461015745134, 1.0330706503030305, 
    1.013297510084807, 1.031694221614695, 1.0620818794851101, 1.0387148368781678, 1.048952134150921, 1.037683683039984, 1.0488867868654077, 1.0686862428762933, 1.0414204515748402, 1.0723599049537171, 
    1.0789432120734788, 1.0717922499335433, 1.1112928408091316, 1.0856866146773463, 1.0856230956051336, 1.1384089148433456, 1.1245415405959454, 1.0627221268009706, 1.1038940275696374, 1.1007282042453037
};

const float NpartNormalizer::ratio_s_obx[] = 
{
    0.7666851065173637, 0.8480389150422616, 0.7561039553396971, 0.77148133408895, 0.8255229289068652, 0.859655126928976, 0.7867031362790268, 0.8113549911800473, 0.8699650309760125, 0.8850113240761434, 
    0.8051044096546477, 0.8511017422738337, 0.8111205548045123, 0.8616373079104005, 0.8529044904430848, 0.8435023005923511, 0.8754699325047893, 0.857647746273661, 0.8562749931889838, 0.9542424723014473, 
    0.8559090077151684, 0.8699681976495865, 0.8855053395259054, 0.928912353253167, 0.9030122124673856, 0.8966205660171568, 0.9486817521542501, 0.8727074845198786, 0.9231146068925962, 0.8852549451070162, 
    0.9501755724450784, 0.9511546710788709, 0.8956384695670047, 0.9545954688158691, 0.9560713012979561, 0.8920464385297688, 0.9630285976562737, 0.9476294594675883, 0.9347673099537862, 0.9667710540048727, 
    0.9030774920036432, 0.9395717986930098, 0.9414356489691047, 0.9811414371494283, 0.9705565290458197, 0.9321787710493589, 0.9701167247365435, 0.9649018795082995, 0.9934492676488866, 0.9794073588630714, 
    0.9966336151812036, 0.989423176963693, 0.9745452465557204, 0.9836849421833748, 1.016182632706065, 1.0035968240858841, 1.0105382549338995, 1.0139685011327073, 1.0433740345087719, 1.0413618869187906, 
    1.0237928886129388, 1.028624737288625, 1.042426813150104, 1.0546566260181804, 1.0776296995982237, 1.0389553268484764, 1.0462009276723612, 1.1024434961102654, 1.0224569895800886, 1.04942467831518, 
    1.0600476567919177, 1.0877392488325042, 1.0680721065302723, 1.1171564578026414, 1.1127255309617519, 1.039014045228315, 1.1124278820305016, 1.0950077258191167, 1.1154575891274956, 1.0836731617015376
};

const float NpartNormalizer::ratio_s_obxb[] = 
{
    0.8668179284988545, 0.904167558755192, 0.7786783187493747, 0.8225893516091441, 0.8892882512904347, 0.9663360727455579, 0.8986638838970278, 0.7448377395738509, 0.9081208408215417, 0.8746021976708386, 
    0.9278646960218763, 0.8143480857837412, 0.8008014079557554, 0.7480528521739983, 0.8211859813519364, 0.8031763378983915, 0.8122286069104004, 0.801624926230039, 0.9279394466137971, 0.8778741778055811, 
    0.8928465287153515, 0.879276365571546, 0.8083571942343427, 0.8504378878149812, 0.8131097019834472, 0.8854402510338817, 0.9103568492909025, 0.9027864820673145, 0.9296074856717871, 0.9233097901058226, 
    0.9562305765403109, 0.9079824268803718, 0.8974430981435754, 0.9673110885788189, 0.8675224727489854, 0.9358420954910524, 0.9123808800380514, 0.8964140060591418, 0.9891026226762586, 0.9283173738175365, 
    0.9515112113596269, 0.9814822807861188, 1.0101648341250475, 0.9949761886160599, 0.9420930630230947, 0.9732912787027231, 1.0046038998033417, 0.9334038256747913, 0.9819122358413971, 1.0446743651581947, 
    1.0235118444482278, 0.9177742564873574, 0.9831474688580659, 1.0274494125059928, 1.0507676795718914, 1.0365017551016553, 0.9725072142875942, 1.0063975391825972, 1.0415811918735387, 1.0070385953206744, 
    0.9948374377720204, 1.0621620352337664, 1.0500557857228416, 1.002806125814224, 1.0635815470158754, 1.0349003683333582, 1.0591238233712674, 1.089962063393407, 1.029695658265293, 1.089083379666034, 
    1.0728963955130248, 1.0222590893185521, 1.0725831754777786, 1.0960095037830537, 1.1078994544541827, 1.1566040032868525, 1.1317093365900068, 1.0185823471432536, 1.1166842047200698, 1.0717522839343485
};

const float NpartNormalizer::ratio_s_x[] = 
{
    0.7391423976580014, 0.814269514218472, 0.7292793814162568, 0.8023663768201296, 0.8957405512595848, 0.8413749711754624, 0.8382661505998231, 0.841014943181075, 0.8718421745503859, 0.8965520279470905, 
    0.8394936122641509, 0.8432381772528726, 0.8179905317617995, 0.8672369717800004, 0.8733309376581112, 0.8223929171788928, 0.8623116469389058, 0.874475064636489, 0.8534740901234104, 0.8993896630432671, 
    0.8548677502931202, 0.9072492606611576, 0.89690384148772, 0.886346757410513, 0.8886529321986983, 0.907790371067857, 0.9131295135853107, 0.9016702021669458, 0.8925655792845372, 0.9255724895278906, 
    0.9461847113035523, 0.9133754463493104, 0.890938066629943, 0.9206643239737046, 0.9643999818567865, 0.9445881625690281, 0.9549336622116846, 0.9597814369798867, 0.925537299854707, 0.9497879819269217, 
    0.9208130361135233, 0.9586883228337043, 0.9549405396914353, 0.972205865036655, 0.984498002176837, 0.9834770739680703, 0.9845889225683521, 0.976831035950112, 0.9941720212742426, 0.9875395177276087, 
    0.99518731712237, 1.010549660439776, 0.9868072460881484, 0.9829694974860238, 1.0108012580661216, 1.0092280137012495, 1.029968486845138, 1.0080915119183527, 1.0316990352953654, 1.03510441033411, 
    1.0231762768311352, 1.0341271129905876, 1.05509721113313, 1.0514384491104698, 1.056498430174351, 1.057338059658183, 1.0539984628524375, 1.0869338511332893, 1.0540121281015151, 1.0750894940073303, 
    1.0728781308431563, 1.0755482382632844, 1.0742181769196564, 1.1163289022236302, 1.1043206983454856, 1.0621229651365827, 1.1194946672445036, 1.0961865921733127, 1.107761874618467, 1.1198529626058804
};

const float NpartNormalizer::ratio_s_xb[] =
{
    0.7716047836265856, 0.8629276954977393, 0.8208568874248002, 0.7917927418174365, 0.845973071192109, 0.9308541226104018, 0.8307672110063984, 0.8035702770861072, 0.8466657379147263, 0.805528965663485, 
    0.8293088546542887, 0.8404856235871142, 0.8567948267549513, 0.8725318358457086, 0.8405645024627282, 0.8824774039933859, 0.7802984959330412, 0.7896386202453141, 0.9602371243165431, 0.8674241012627774, 
    0.801023594889432, 0.8585540236753685, 0.8423942907669317, 0.892245951983493, 0.8845022194323438, 0.8805181743954898, 0.8847905665329897, 0.9069653725288708, 0.9076915488251247, 0.9105899580860847, 
    0.9255725039475388, 0.9041532377827346, 0.9154572512708449, 0.9382942407296535, 0.9100162054187628, 0.9132205057928681, 0.9370049458773454, 0.9135860712678001, 0.9364667945227609, 0.939523900936397, 
    0.9700805463473404, 0.9806522929117105, 0.9964543424335846, 0.9874218823746771, 0.9759266058711913, 0.9743429460887688, 0.9742005480611892, 0.9533518674744647, 0.9691868949753154, 1.0297911434673606, 
    1.008667879706504, 0.9678504798556374, 1.0133802002460703, 1.018584682061765, 1.0224098369349097, 1.027324904251966, 1.0037516234186319, 1.026132575716785, 1.0332388950278781, 1.042257441665843, 
    1.018400341329003, 1.0395578213414451, 1.0618177417816959, 1.041345320230222, 1.0464372401154824, 1.0480507821817464, 1.0536547522073638, 1.0741481188941793, 1.0428524296250223, 1.0794662948945764, 
    1.0767007395760038, 1.0699434922170954, 1.1135781571818992, 1.0832422109662947, 1.0853390984441047, 1.1413480428279996, 1.1186201602745565, 1.062559308114196, 1.1116065779756186, 1.1015065867813167
};

const float NpartNormalizer::ratio_s_o[] = 
{
    0.6468211708505176, 0.6399587943906401, 0.6896582292739403, 0.69267377839968, 0.7115795087044333, 0.7001314944517965, 0.7070744568022539, 0.6932837585468962, 0.6866160793753653, 0.7136118244922405, 
    0.7025042209349519, 0.7258531332199135, 0.7367405261036458, 0.7562966643101547, 0.7408221109701607, 0.7488863428215959, 0.7521706630150902, 0.7613743327815742, 0.754200589868821, 0.7565418553784381, 
    0.7665394561332812, 0.771664891289748, 0.7802246557780194, 0.7755412340847886, 0.7986801345571609, 0.7999811255660227, 0.8369500451923526, 0.8280614665747893, 0.8157074698230987, 0.8136188657220481, 
    0.8415721352522288, 0.8638444804587352, 0.8361191074085011, 0.8641442294050712, 0.8845095927657416, 0.87868773554276, 0.8865494092660088, 0.8966673140534224, 0.8982223871187159, 0.9161680568963548, 
    0.9313422480258112, 0.9455361217882858, 0.9221590665790868, 0.9505886011136296, 0.955297365977954, 0.9629538607242264, 0.9802426874447128, 0.9742682891671216, 0.9757799720303878, 1.008225665094542, 
    0.9795859472203489, 1.0095128550797798, 1.0250780588604713, 1.0334172801865074, 1.0274210481936128, 1.0234854012286263, 1.0631780147054166, 1.057060801034993, 1.0844820877077803, 1.0694747412156806, 
    1.0778653006694927, 1.1043747977148168, 1.0801943316331868, 1.1209976290446477, 1.1023426634016125, 1.1322617139733633, 1.1619025836124115, 1.1507636990220504, 1.1698377889611251, 1.1921580584189546, 
    1.2009740097874726, 1.1971332599764046, 1.2058638873466647, 1.2290656636879198, 1.2641136866173506, 1.2659379814304201, 1.2751911968200789, 1.2609186148193627, 1.2507067199263775, 1.3014680421951084
};

const float NpartNormalizer::ratio_s_ob[] = 
{
    0.7763236620732894, 0.7986391220547149, 0.8135807129684078, 0.8035590530990722, 0.825331480098483, 0.8082576014494868, 0.8277334287218673, 0.8176232161299493, 0.8265827967830195, 0.84348471884527, 
    0.8471421722406691, 0.8510259161710599, 0.8428089490655011, 0.8547024111840604, 0.8593119611988773, 0.8590055720021326, 0.8714168712428488, 0.8584499169256898, 0.88098262950984, 0.8851122397246566, 
    0.8641391626955969, 0.8823992552135228, 0.8674488244268367, 0.8962419979067715, 0.8722476563741419, 0.8806444382232651, 0.8850215819626117, 0.8997534691944148, 0.8639619324131854, 0.9028293638002833, 
    0.9203293999351417, 0.9187142936252622, 0.9313594292343368, 0.9202390311031141, 0.9308286183673983, 0.9411281057419645, 0.9362589820926773, 0.9420987704622588, 0.9315836989255942, 0.938451368482148, 
    0.9573275195734302, 0.9622844012523095, 0.9607745597529408, 0.9570492456766414, 0.9606550821229477, 0.969895632881935, 0.9899755714833325, 0.9798099323349969, 0.9739258108791836, 0.9803010933935067, 
    0.9971149388054135, 1.0001578940013596, 1.0014619570970082, 1.0046850129723104, 1.0034957489825895, 0.9978272015987208, 1.0116282536164214, 1.0308549031240042, 1.0335626397613955, 1.0282453384754557, 
    1.0339705480631127, 1.0396667046974797, 1.058222793914761, 1.050155129611789, 1.0616211329446286, 1.0671626453983072, 1.0631825980013228, 1.070862178676644, 1.0759049158564655, 1.0699537828341277, 
    1.0795979063186376, 1.0820074657848993, 1.108898627804253, 1.0984170411429643, 1.1076090689610147, 1.122742148197221, 1.106795353164235, 1.1371208652688283, 1.1382352167055674, 1.103251350169892
};

const float NpartNormalizer::ratio_s_woallx_for_wx[] =
{
    0.7295395760667605, 0.8067460896934963, 0.7227752717135484, 0.7937947629432448, 0.8887383646958634, 0.8364756389373567, 0.830694924998381, 0.8309049030163467, 0.8642153709304381, 0.8870448524763819, 
    0.831977938653565, 0.8352824878734361, 0.812190845826499, 0.862034124552614, 0.8665676554543118, 0.8171424649804666, 0.8529378196896192, 0.864840812460046, 0.8519927184546663, 0.8937975688671553, 
    0.8464642812174825, 0.9000370281801217, 0.8891453514415324, 0.880648665766284, 0.8830517970171193, 0.9022468557351319, 0.907869342568839, 0.8965059933477943, 0.8877743822215729, 0.9214136158063411, 
    0.9424052106383618, 0.9090891112524393, 0.8868934566643177, 0.9175584121677564, 0.9596320888995851, 0.940176592542386, 0.9513847681057518, 0.9552933579889717, 0.9228490636827364, 0.9465216367055577, 
    0.9200311291926259, 0.95796781601671, 0.9551094816141004, 0.9717940773654287, 0.9828755533030862, 0.9828237122178078, 0.9830303327512999, 0.9742794509477571, 0.9922302624339489, 0.989227169818509, 
    0.9957016345826997, 1.00882426597576, 0.9876937094490652, 0.9841989935865287, 1.0122068009189509, 1.0103242200779368, 1.0305742783175629, 1.0091955930113259, 1.0341577210095696, 1.0371216177778881, 
    1.024653133784659, 1.0366443037843815, 1.0585425278035503, 1.0545338758648386, 1.0587554506142378, 1.0601927831636084, 1.056826833649323, 1.0904573936269282, 1.0564728554441962, 1.080156102377907, 
    1.077127789529369, 1.0792837791753218, 1.0808095224701457, 1.1213388328444172, 1.109047105268778, 1.0697588961177453, 1.1270963983991737, 1.0995436253733424, 1.113841494955973, 1.126167489444405
};

const float NpartNormalizer::ratio_s_woallx_for_wxb[] =
{
    0.7483215534238714, 0.8432542064645745, 0.796381645196064, 0.7744742396235035, 0.8363277645846648, 0.9123206723109242, 0.8156090914453705, 0.7879092434169839, 0.8339347327005427, 0.7958832867003098, 
    0.8144193005551409, 0.8248578102578278, 0.8397063020686271, 0.8601677619903446, 0.8291711370578954, 0.8647526197377668, 0.7687884537533434, 0.7785646051400663, 0.9448283018366355, 0.8582977209415777, 
    0.7885024695059469, 0.8491925460639708, 0.8323576371463854, 0.8802140575547943, 0.8732700487141517, 0.8715767032343869, 0.8764416824978776, 0.8962252425753119, 0.8963087220214276, 0.9031870236101632, 
    0.9199171225352417, 0.8956930236285837, 0.904192837525052, 0.9298391973096459, 0.906188637628105, 0.90745201458761, 0.9318959001652086, 0.9093451121287872, 0.929065020247191, 0.9339966377823156, 
    0.9621805789430925, 0.9763775012951089, 0.9917911912922424, 0.9845843599819779, 0.9738584855051476, 0.9732057564250831, 0.9722974491640194, 0.9507236470954253, 0.9682284093784307, 1.0285056017601535, 
    1.0081873587029966, 0.9689725872054405, 1.0120831140210638, 1.0169241698494895, 1.023864972715691, 1.0280288059668803, 1.0075109020379827, 1.0267786416683016, 1.0375648375473103, 1.0460707136681662, 
    1.021528518543109, 1.0439004349978742, 1.0683864383825223, 1.0481476690694624, 1.052736381474849, 1.0549619869789169, 1.0598809826760587, 1.0838944406601114, 1.0492444059644674, 1.0891237902274726, 
    1.0854111929979082, 1.0787754893544188, 1.1230222488206842, 1.0974715545855995, 1.0977902178261947, 1.1490223990506767, 1.1342131867717544, 1.0737581483951797, 1.1245973393760251, 1.1166239744869544
};

const float NpartNormalizer::ratio_s_woallo_for_wo[] = 
{
    0.6106832407055406, 0.6007013717859636, 0.6505742512191672, 0.6703101906834407, 0.6624578562602813, 0.6519253945901723, 0.6785023587228359, 0.6555494650399578, 0.6448726067769982, 0.7022409471816059, 
    0.6718404485927346, 0.697970042081508, 0.7072736704422808, 0.7172056173571371, 0.7041403972749248, 0.7197082259096873, 0.7226444180973293, 0.7361304909837223, 0.7277618180829, 0.7287779932375723, 
    0.7345607156305473, 0.7297969943927659, 0.746757136347501, 0.7565463773224897, 0.7663390813217497, 0.769842966586202, 0.7970819000022007, 0.7971801375005954, 0.7810228933271489, 0.7936557192976449, 
    0.819287603323425, 0.8460034944156605, 0.8297423269393948, 0.838953604828955, 0.8853889431664784, 0.8633407255008079, 0.868487487489999, 0.8839630370423563, 0.8787353435483461, 0.8965940908881332, 
    0.9236632314629094, 0.9349732533326137, 0.9225837765529012, 0.9429735057292394, 0.9379743353075579, 0.963329999932315, 0.9747369965665407, 0.9804903853691217, 0.9578586887584145, 1.0045290759844807, 
    1.001818200661765, 1.0128884048904778, 1.0438122021079994, 1.0393236343862655, 1.0310971994946407, 1.026322767906811, 1.073294722816052, 1.064830390424404, 1.1140625203838614, 1.0830812993701893, 
    1.0940055058015479, 1.1300831041948394, 1.106935556131448, 1.1387156605881295, 1.136208154323807, 1.1505719381210227, 1.1874084938160219, 1.180285022933765, 1.1935533732113337, 1.2386476200591254, 
    1.2346257160254357, 1.2376889130473414, 1.2519570238194977, 1.2589218817165866, 1.306513857104925, 1.3390189173845195, 1.3402424065378893, 1.3240038681065804, 1.3009051497276194, 1.3499249749978532
};

const float NpartNormalizer::ratio_s_woallo_for_wob[] = 
{
    0.5433523172534229, 0.5460783430680444, 0.5925466028038184, 0.6049053477608426, 0.606721635129427, 0.5898152123676719, 0.6232152596460812, 0.5986888014244436, 0.5942142735607472, 0.6526134259803633, 
    0.6275868984744752, 0.6510934090426684, 0.6540771662305737, 0.6673330361562423, 0.6593946418155973, 0.6728377601929346, 0.6818213309340385, 0.6863902008133173, 0.6915082038326429, 0.6943853017646305, 
    0.6874135609755334, 0.6921258233076123, 0.6990515622711407, 0.7246063944495913, 0.7179493412442043, 0.7257864647476214, 0.7498220866829541, 0.7592900528819301, 0.7250664551827445, 0.7593032357638019, 
    0.7907150112547189, 0.8130236937476018, 0.8078174697081469, 0.8071091891351055, 0.8559886487428011, 0.8414307094767036, 0.8426775892711883, 0.8601252147101419, 0.8485268013696512, 0.8680779921649246, 
    0.9044961978683463, 0.9171792104442191, 0.9065669277863255, 0.9211823382672422, 0.9180835753023873, 0.9480424773606636, 0.9703792051182903, 0.9701780281968093, 0.9439028927988317, 0.990767521814847, 
    1.002081685054185, 1.012011439113976, 1.042175799207933, 1.039014731501641, 1.0305995539667523, 1.0224583529028186, 1.0747586215443694, 1.0798997593572432, 1.1289351209327558, 1.0953781788615442, 
    1.1095410344470467, 1.147520647351748, 1.139164135748561, 1.1621038974720572, 1.169417782251445, 1.1851659015228644, 1.2173551584565843, 1.2166417792898692, 1.2321600060928806, 1.2721061294153806, 
    1.2743701853731522, 1.2796877759144034, 1.3137167149963473, 1.311043045604437, 1.3644933067650593, 1.4101585588506853, 1.3980659787837435, 1.4058654790929188, 1.3831158946194302, 1.4030047154492145
};


float NpartNormalizer::weight(int np, TString compare_case)
{
    if (IsUnitWeight) return 1.;

    if (mode == 1) // string-melting
    {
        if (np < lowest_np || np >= lowest_np + 80) return 0;
        if (compare_case == "ox")   return ratio_s_ox[np-lowest_np];
        if (compare_case == "oxb")  return ratio_s_oxb[np-lowest_np];
        if (compare_case == "obx")  return ratio_s_obx[np-lowest_np];
        if (compare_case == "obxb") return ratio_s_obxb[np-lowest_np];

        if (compare_case == "x")  return ratio_s_x[np-lowest_np];
        if (compare_case == "xb") return ratio_s_xb[np-lowest_np];
        if (compare_case == "o")  return ratio_s_o[np-lowest_np];
        if (compare_case == "ob") return ratio_s_ob[np-lowest_np];

        if (compare_case == "woallx_for_wx")  return ratio_s_woallx_for_wx[np-lowest_np];
        if (compare_case == "woallx_for_wxb") return ratio_s_woallx_for_wxb[np-lowest_np];
        if (compare_case == "woallo_for_wo")  return ratio_s_woallo_for_wo[np-lowest_np];
        if (compare_case == "woallo_for_wob") return ratio_s_woallo_for_wob[np-lowest_np];
    }
    else if (mode == 0) // default
    {
        return 1.;
    }
    else if (mode == 2) //UrQMD
    {
        return 1.;
    }

    return 0;
}


