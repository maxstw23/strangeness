#include "NpartNormalizer.h"
#include "TString.h"

const float NpartNormalizer::ratio_ox[] =
{
    0.812621657248932, 0.8017736938027825, 0.8519406874637606, 0.8157622127981018, 0.8387671415731145, 0.8635376618693645, 0.8898252476905187, 0.8695187531223864, 0.8893860163231249, 0.9060726614078762, 
    0.9012082724028879, 0.9041790680652055, 0.8865220218728429, 0.9348507851423492, 0.9090526374580088, 0.9427034826703032, 0.9301304925328766, 0.934086120436016, 0.9307646549472385, 0.9584187035339616, 
    0.9595663534039773, 0.9618151918833627, 0.9676800862142984, 0.9796063155090969, 0.98982471526682, 0.9906386683956582, 1.018360734182821, 1.0024395688700176, 1.0263558623733111, 1.0272881973290031, 
    1.0398354060046844, 1.0417193422936852, 1.0506497329954285, 1.0523889952692225, 1.060901583305789, 1.0786124134821615, 1.0918499798379775, 1.0813971680370627, 1.0870000986020891, 1.0973685878728778 
};


const float NpartNormalizer::ratio_oxb[] = 
{
    0.907077763226021, 0.8883316591220617, 0.8272369292939524, 0.8482502962666552, 0.8512967569155615, 0.8628132020072442, 0.8217150995921083, 0.8618847471233329, 0.8640003533911907, 0.8716127216618083, 
    0.8986789005766761, 0.9097517851588796, 0.9016339679449056, 0.8941264357983689, 0.8933712692362371, 0.9249441529692414, 0.9448443375327005, 0.9353312912502618, 0.9480377109891635, 0.944121369615169, 
    0.9515190244189797, 0.9421693771273024, 0.9991240573445176, 0.9759307059074399, 0.997252701850723, 0.9838805355052447, 1.0189639848363339, 1.024476325738933, 1.0159137615253984, 1.039769960478326, 
    1.0206877561573164, 1.0371858460414962, 1.0607818473825135, 1.0572738101237675, 1.07230065424195, 1.0791436500941378, 1.0605727589296046, 1.0840817957934143, 1.0998850714380732, 1.1220921934631378 
};

const float NpartNormalizer::ratio_obx[] = 
{
    0.8108441178113037, 0.8131179294561304, 0.8771438452219268, 0.8007385166613703, 0.8289200578790727, 0.8855506286657593, 0.9095256296547561, 0.8941917142213532, 0.8774263279033289, 0.9098685818398174, 
    0.8897242103584634, 0.9214761183364343, 0.9122328039650359, 0.9166297489079288, 0.9094664026242061, 0.9201135283137071, 0.9518080369061235, 0.9300016487685578, 0.9211042359291342, 0.9482902032206839, 
    0.9730028712857317, 0.9685547167886528, 0.9476687709508137, 0.9730234957659338, 0.9902631813753054, 0.9845906154523553, 1.0187236938088917, 1.0045879754322733, 1.0160504362034584, 1.0096371327529547, 
    1.0523068727855291, 1.0308113684245221, 1.0457758382447697, 1.0611679412723347, 1.0602880769596392, 1.052716322693269, 1.0864883394214842, 1.077499675173007, 1.0678921497720308, 1.0862075322313007
};

const float NpartNormalizer::ratio_obxb[] = 
{
    0.8753801590103281, 1.003262483725158, 0.8536225338324641, 0.8880970915462494, 0.8460471041852146, 0.8677225545103077, 0.8211510472487958, 0.8198233651756734, 0.8678052719168345, 0.9208095699989138, 
    0.8950374985823405, 0.9043421084769594, 0.9001498519552255, 0.8875440159649423, 0.8571103202274403, 0.9428147279398821, 0.9494253693167112, 0.9174485158461907, 0.9470390268853951, 0.9509046532998856, 
    0.9553921800454627, 0.9644872999237124, 1.0331565773153522, 0.9553112406022134, 0.9754712511484842, 1.009487188351675, 1.0195137392895226, 1.0039126218836887, 0.984853325713581, 1.0368462407329728, 
    1.0161601289763, 1.001892403517876, 1.0473907874862625, 1.1073439659071014, 1.054408858224431, 1.0593886741505782, 1.0676099777657073, 1.096572881669783, 1.079901146330058, 1.1121123114169484
};

const float NpartNormalizer::ratio_x[] = 
{
    0.8172860612686388, 0.8052439203343736, 0.8589106832677433, 0.8246932452028144, 0.8386784020104087, 0.8647068799474897, 0.9055515757527907, 0.8704026194595662, 0.8881255846883963, 0.9053185570651356, 
    0.9055035172755003, 0.90791827762759, 0.8878518997967486, 0.9369918976198617, 0.9065242094880466, 0.9390991086991277, 0.9311772947553295, 0.9363263294051586, 0.9361899463088337, 0.9548877615877397, 
    0.9616256373883222, 0.9683572516590596, 0.9702756843245292, 0.9763595615183572, 0.9910818240199818, 0.9901914620994748, 1.0213358087740374, 1.0032054364513843, 1.0282309397683407, 1.0300259749333889, 
    1.0409484541942775, 1.0414868336419025, 1.052345804201895, 1.0526207564088412, 1.0607510687679222, 1.078684852124406, 1.09423276248809, 1.0832713864599102, 1.0907002478950747, 1.0972753485616455
};

const float NpartNormalizer::ratio_xb[] =
{
    0.884864381587245, 0.8797593346516083, 0.823645705403062, 0.8389914185812705, 0.8465174818488315, 0.8574354331641191, 0.822413864707596, 0.8638995764750891, 0.8689828506287578, 0.8696303193953573, 
    0.8941972963226285, 0.909586172959718, 0.8950167058811036, 0.8947507106430356, 0.8913746081824345, 0.9213220212384552, 0.9450252890336476, 0.9379785355166903, 0.9506625946472123, 0.9487808307800478, 
    0.9540582352303529, 0.9456037495572541, 0.9988603449547071, 0.9766367501810259, 0.9943100541892919, 0.9928744739399863, 1.0234123553424135, 1.0215063698471518, 1.0183472422072573, 1.0427266901420966, 
    1.0286469733522776, 1.0380569483532693, 1.0644768663092743, 1.0555643333867533, 1.0743335347047347, 1.0777961073864801, 1.0617383712373576, 1.0896231007880828, 1.1063827803077453, 1.113922110647276
};

const float NpartNormalizer::ratio_o[] = 
{
    0.6836728569030628, 0.6985907786745136, 0.7281333299760593, 0.7406295085728073, 0.7438122477889207, 0.7678981622724644, 0.7593786568235023, 0.7564577649084302, 0.7743014883297644, 0.7786145219602518, 
    0.8002406796740431, 0.8202662150163964, 0.8290568571902678, 0.8294834832939925, 0.8369250846683056, 0.8655403348794544, 0.8677464347329347, 0.8978924496446273, 0.9183993393378829, 0.9233440816093976, 
    0.9267919966528381, 0.9473550919246201, 0.9501997339653757, 0.9604816068086657, 1.009550654874587, 1.0178268310848473, 1.0041981611795694, 1.0320772483818057, 1.0512755727387002, 1.0772551725332655, 
    1.08162677010994, 1.1037820574098582, 1.1304546705247698, 1.1433152506187139, 1.1660311125613168, 1.1807938462389227, 1.2046770022734439, 1.229437428878175, 1.2508385883495927, 1.2299199533415623
};

const float NpartNormalizer::ratio_ob[] = 
{
    0.8316126067015096, 0.8413852582974178, 0.8420997390366648, 0.8347689730383397, 0.8420317068230231, 0.8588652321941957, 0.8733107492185423, 0.8888984846180095, 0.8841093995424701, 0.8864276192300269, 
    0.8946743774571022, 0.8917610432000789, 0.8996031180546392, 0.9062796438858503, 0.9137315947501999, 0.9209340513706932, 0.9346156509901534, 0.9218561330778497, 0.9376542966950531, 0.9588385043569941, 
    0.9615197897481198, 0.9635037253618857, 0.9674275372842708, 0.971333372909017, 0.9869741593483484, 0.992920139166649, 1.0125570480387154, 1.01898212207994, 1.015184143446347, 1.0268500603037525, 
    1.027853353781847, 1.0457036808552578, 1.0506118023157953, 1.0668702432672055, 1.0788659248502979, 1.0845641945896505, 1.0926680843009247, 1.1009686267368064, 1.1130066043231859, 1.108658756757662
};

float NpartNormalizer::weight(int npp, TString compare_case)
{
    if (npp < lowest_npp || npp >= lowest_npp + 40) return 0;
    if (compare_case == "ox")   return ratio_ox[npp-lowest_npp];
    if (compare_case == "oxb")  return ratio_oxb[npp-lowest_npp];
    if (compare_case == "obx")  return ratio_obx[npp-lowest_npp];
    if (compare_case == "obxb") return ratio_obxb[npp-lowest_npp];

    if (compare_case == "x")  return ratio_x[npp-lowest_npp];
    if (compare_case == "xb") return ratio_xb[npp-lowest_npp];
    if (compare_case == "o")  return ratio_o[npp-lowest_npp];
    if (compare_case == "ob") return ratio_ob[npp-lowest_npp];

    return 0;
}


